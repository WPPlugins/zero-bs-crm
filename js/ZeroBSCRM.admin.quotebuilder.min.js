function zbscrm_appendTextToEditor(e){window.parent.send_to_editor(e)}function zbscrm_getTemplatedQuote(e,t){if(!window.quoteTemplateBlocker){var o=jQuery("#zbscq_customer").val(),u=parseInt(jQuery("#zbs_quote_template_id").val()),r=jQuery("#name").val(),i=jQuery("#val").val(),n=jQuery("#date").val();if(console.log("here",[o,u]),empty(o))return empty(o)&&swal({title:"Error!",text:"Please Choose a Customer",type:"error",confirmButtonText:"OK"}),empty(u)&&swal({title:"Error!",text:"Please Choose a Template",type:"error",confirmButtonText:"OK"}),window.quoteTemplateBlocker=!1,!1;empty(u)?(window.quoteTemplateBlocker=!1,"function"==typeof e&&e()):(quoteTemplateAJAX=jQuery.ajax({url:ajaxurl,type:"POST",data:{action:"zbs_get_quote_template",cust_id:o,quote_type:u,quote_title:r,quote_val:i,quote_dt:n,security:jQuery("#quo-ajax-nonce").val()},dataType:"json"}),quoteTemplateAJAX.done(function(t){swal({title:"Success!",text:"Quote Template Populated",type:"success",confirmButtonText:"OK"}),zbscrm_appendTextToEditor(t.html),window.quoteTemplateBlocker=!1,"function"==typeof e&&e()}),quoteTemplateAJAX.fail(function(){swal({title:"Error!",text:"Failed retrieving template! If this error persists please contact ZBS CRM support.",type:"error",confirmButtonText:"OK"}),window.quoteTemplateBlocker=!1,"function"==typeof t&&t()}))}}function zerobscrm_js_sendQuoteNotification(e,t,o,u){if(!window.zerobscrm_js_sendingQuote)if(window.zerobscrm_js_sendingQuote=!0,"undefined"!=typeof e&&""!=e&&zbscrm_JS_validateEmail(e)&&"undefined"!=typeof t&&t>0){var r={action:"zbs_quotes_send_quote",sec:window.zbscrmjs_secToken,em:e,qid:t};jQuery.ajax({type:"POST",url:ajaxurl,data:r,dataType:"json",timeout:2e4,success:function(e){"function"==typeof o&&o(e),window.zerobscrm_js_sendingQuote=!1},error:function(e){console.error("RESPONSE",e),"function"==typeof u&&u(e),window.zerobscrm_js_sendingQuote=!1}})}else window.zerobscrm_js_sendingQuote=!1}var quoteTemplateBlocker=!1;jQuery(document).ready(function(){jQuery("#zbsQuoteBuilderStep2").click(function(){zbscrm_getTemplatedQuote(function(){jQuery("#wpzbscsub_quotecontent").show(),jQuery("#wpzbscsub_quoteactions").show(),jQuery("#zbs-quote-builder-step-1").slideUp(),setTimeout(function(){jQuery("#zbs_quote_content_ifr").css("height","580px"),jQuery("html, body").animate({scrollTop:jQuery("#wpzbscsub_quotecontent").offset().top},2e3)},0)})}),jQuery("#zbsQuoteBuilderStep3").click(function(){jQuery("#publish").click()}),jQuery("#zbsQuoteBuilderEmailTo").keyup(function(){var e=jQuery("#zbsQuoteBuilderEmailTo").val();"undefined"!=typeof e&&""!=e&&zbscrm_JS_validateEmail(e)?(jQuery("#zbsQuoteBuilderEmailTo").css("border","1px solid #ddd"),jQuery("#zbsQuoteBuilderEmailToErr").hide()):(jQuery("#zbsQuoteBuilderEmailTo").css("border","2px solid orange"),jQuery("#zbsQuoteBuilderEmailToErr").show())}),jQuery("#zbsQuoteBuilderSendNotification").click(function(){var e=!0,t=jQuery("#zbsQuoteBuilderEmailTo").val(),o=jQuery("#zbsQuoteBuilderEmailTo").attr("data-quoteid");"undefined"!=typeof t&&""!=t&&zbscrm_JS_validateEmail(t)||(e=!1),e&&zerobscrm_js_sendQuoteNotification(t,o,function(){swal({title:"Success!",text:"Quote has been emailed!",type:"success",confirmButtonText:"OK"})},function(){swal({title:"Error!",text:"Failed Sending email to customer! If this error persists please contact ZBS CRM support.",type:"error",confirmButtonText:"OK"})})}),"undefined"!=typeof window.zbscrm_templated&&(jQuery("#zbs-quote-builder-step-1").hide(),jQuery("#wpzbscsub_quotecontent").show(),jQuery("#wpzbscsub_quoteactions").show()),jQuery("#zbsQuoteBuilderURL").length&&(document.getElementById("zbsQuoteBuilderURL").onclick=function(){this.select(),document.execCommand("copy")})});var zerobscrm_js_sendingQuote=!1;